could be optimized with HashSets